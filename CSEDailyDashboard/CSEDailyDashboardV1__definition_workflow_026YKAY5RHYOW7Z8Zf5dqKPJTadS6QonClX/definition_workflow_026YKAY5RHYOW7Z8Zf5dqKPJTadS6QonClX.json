{
  "workflow": {
    "unique_name": "definition_workflow_026YKAY5RHYOW7Z8Zf5dqKPJTadS6QonClX",
    "name": "CISCO Secure Endpoint - Daily dashboard",
    "title": "CISCO Secure Endpoint - Daily dashboard",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.A 3",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8PTGQ8H6G41m9EgrH9vPRcBEWjHc3vX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.A 2",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8PL4N22X914lPeT9JB4ZYxb7xhPgajl",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.B 3",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QV9TMMPC68DpP8o8fBvm3Anr8Ql8wK",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.A 5",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8PX1Y852F3jQB9wdkqh3ei3vhiZqJ5x",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.B 1",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QPJAMFW83LGLLjAaR9S3ik4XHYb5XK",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.A 5",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8PCWKVXDD37FS9iLgnlyutAgxq8dr8v",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.B 5",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8R3BHSR804pxNCJtImvQB19kP2hbtr3",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.B 2",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8Q4ZANWAF7RuaCVvtbTMjvzkSUsatOk",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.B 2",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QS6Z8Y0K7Lx4qF8LyjPQ5vapK72IGj",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.A 4",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8P8TAS28Y3ZV2dbhEjqGLlKlqWiMhTa",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.B 4",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QZH9ADGX7kIpPZqCTLMLioAh6dYn5n",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "mensaje",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026YL12O9176W6ypQgeJDoVNpRBR2mKXFV6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "fecha",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026YKDF8BBRIZ2s4ao9nZFgUpFjReRJpR2j",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.A 4",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8PP6RE0N15Om8uzee7xMYGZJMwIxJTF",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.A 3",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8P4P6A41N6r8QnEtjqKNZWVa4HABTID",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.B 4",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QFMCQBAI0KkT5YcNnRpbyG2q2bAlmN",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "offset",
          "type": "datatype.integer",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026YKHPKBTFPS5K48FWI2RbOdaSiJpdlMHy",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.B 1",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8Q0XO79OZ4RuXiqvqPqrcS20l70fOMe",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.B 5",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QJY4JTCE2KSpAAT8gF6sr8wnR5Obx1",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "YzE1MjdkNjAtODAyZS00ZDUxLThhMDAtMjNmY2VmMWEyNjc4ZDUyYjI2MjgtZGEy_PF84_a3fed6c8-d5ed-4ebb-a07d-4406b551f101",
          "scope": "local",
          "name": "token",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026YL3U74GXPZ04drN3zbc7cFvCscN2cnSY",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.A 2",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8OZ4NHWF63vta14333gqc8qQaogsTCW",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": true,
          "scope": "local",
          "name": "flag",
          "type": "datatype.boolean",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026YKHX0BG78O5YDRXn8IrBlG4v6x3UKlZ5",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "data",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026YKID8W8EX66TKDbla1SVNvj3WaQssemZ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.A 1",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8OUW4WV1S1eGFHctDxcfE4yY0P7Waqv",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "count.A 1",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8PHBGR6R41VkPxmrytrlhMUNv1yQAY1",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "category.B 3",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_026Z8QBCHZ4964GP3dz7hopjUHkpzBfI2pu",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "CISCO Secure Endpoint - Daily dashboard",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_026YKB4OCOTYO1mgvvgYo4Hm7UflSeJTRz6",
        "name": "Calculate Date",
        "title": "Calculate Date",
        "type": "core.calculate_date",
        "base_type": "activity",
        "properties": {
          "adjustment": -172800,
          "continue_on_failure": false,
          "display_name": "Calculate Date",
          "original_date": "$workflow.definition_workflow_026YKAY5RHYOW7Z8Zf5dqKPJTadS6QonClX.output.start_time$",
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_026YKD7T7JYA22MEpxXnDzMoaMqeJPRPyt6",
        "name": "Set Variables",
        "title": "Set Variables",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set Variables",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$workflow.definition_workflow_026YKAY5RHYOW7Z8Zf5dqKPJTadS6QonClX.local.variable_workflow_026YKDF8BBRIZ2s4ao9nZFgUpFjReRJpR2j$",
              "variable_value_new": "$activity.definition_activity_026YKB4OCOTYO1mgvvgYo4Hm7UflSeJTRz6.output.result$"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_026YKF1JT5JPE4YhB9yl8n0xTiz9rivU1jq",
        "name": "Split String",
        "title": "Split String",
        "type": "core.splitstring",
        "base_type": "activity",
        "properties": {
          "boundaries": [
            {
              "boundary": "T"
            }
          ],
          "continue_on_failure": false,
          "display_name": "Split String",
          "input_string": "$workflow.definition_workflow_026YKAY5RHYOW7Z8Zf5dqKPJTadS6QonClX.local.variable_workflow_026YKDF8BBRIZ2s4ao9nZFgUpFjReRJpR2j$",
          "skip_execution": false,
          "use_regexp": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48",
        "name": "Execute Python Script",
        "title": "Execute Python Script",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Execute Python Script",
          "script": "import requests\nimport json\nfrom datetime import datetime, timedelta\nimport sys\n\nusername = \"7c423a43656c88add2ee\"\npassword = \"8fdb2fae-edb9-4bba-a7b0-0c20f33b1f3e\"\ndata = []\n\n#**************************************************************************************************************************************************************#\n#Obtiene toda la información de los eventos y almacena el json en data\nfor i in range(0,10000,500):\n    response = requests.get(f\"https://api.amp.cisco.com/v1/events?limit=500\u0026offset={i}\u0026start_date={sys.argv[1]}\",auth=(username,password))\n    if response.status_code == 200:\n        response = json.loads(response.text)\n        if len(response['data']) != 0: \n            data += response['data']\n        else:\n            break\n    \n#**************************************************************************************************************************************************************#\n#Recorre los elementos del json de los eventos y obtieene aquellos que tienen el key severity, no existe aún en la lista de eventos y el tipo de evento comienza con 11072962, para después agregarlos a la lista de eventos\neventos = []\ntrue = 0\n\nfor item in data:\n    if 'severity' in item and item['event_type'] not in eventos and '11072962' in str(item[\"event_type_id\"]):\n        eventos.append(item['event_type'])\n\n#Elimina los duplicados e inicializa cada evento con un contador en 0\neventos = list(set(eventos))\neventos = [[evento,0] for evento in eventos]\n\n#**************************************************************************************************************************************************************#\n#Recorre la lista de eventos y el json de los eventos para obtener la severidad de cada evento registrado en la lista y contabilizar la incidencia encontrada, luego guarda esa información en la lista severidades_evento\nseveridades_evento = []\n\nfor evento, i in zip(eventos,range(len(eventos))):\n    severiti = []\n    for item in data:\n        if 'severity' in item and item['event_type']  == evento[0]:\n                eventos[i][1] += 1\n                severiti.append(item['severity'])\n    severidades_evento.append({\"Evento\":evento[0],\"Severidades\":severiti})\n\n#Ordena de mayor a menor los eventos a partir del contador\neventos.sort(key=lambda x: x[1], reverse=True)  \n\n#**************************************************************************************************************************************************************#\n#Obtiene todos los hosts del json de los eventos que tienen el key severidad y los almacena en la lista hosts\nhosts = []\ntrue = 0\n\nfor item in data:\n    if 'severity' in item and item['computer']['hostname'] not in hosts:\n        hosts.append(item['computer']['hostname'])\n\n#Convierte la lista hosts en un diccionario       \nhosts = [{\"Hostname\":host} for host in hosts]\n\n#Agrega al diccionario un key con el total general para cada hostname y luego inicializa el contador en cada evento asignado al hostname almacenado\nfor i in range(len(hosts)):\n    hosts[i]['data'] = {\"Total\":0}\n    for j in range(len(eventos)):   \n        hosts[i]['data'][eventos[j][0]] = 0\n\n#**************************************************************************************************************************************************************#\n#Obtiene la información del json de los eventos para identificar aquellos hostnames que ya se encuentran en el diccionario de hostnames y registrar la severidad de cada uono de los eventos registrados \n#Agrega a la lista severidades_host objetos que representan al host y el recuento de sus severidades\nseveridades_host = []\n\nfor host, i in zip(hosts,range(len(hosts))):\n    total = 0\n    severiti = []\n    for item in data:\n        if 'severity' in item and item['computer']['hostname'] == host['Hostname']:\n            if item['event_type'] in host['data']:\n                hosts[i]['data'][item['event_type']] += 1\n                hosts[i]['data'][\"Total\"] +=1\n                severiti.append(item['severity'])\n    severidades_host.append({\"Hostname\":host['Hostname'],\"Severidades\":severiti})\n\n#Ordena los hosts de mayor a menor a poartir del total general de cada hostname\nhosts = sorted(hosts, key=lambda x: x['data']['Total'],reverse=True)\n\n#**************************************************************************************************************************************************************#\n#Obtiene el detalle de las amenazas de todos los hostnames detectados con los eventos que inician en 11072962: Severidad, nombre del archivo y nombe del host\n#formatea el resultado para mostrar la información anterior de la siguiente manera: Severidad X detected nombre_archivo *Lista de hostnames detectados con esa amenaza*\namenaza = ''\n\nfor item in data:\n    hoststhreats = \"\"\n    try:\n        if 'severity' in item and 'file' in item and '11072962' in str(item[\"event_type_id\"]):\n            for dato in data:\n                try:\n                    if item['severity'] == dato['severity'] and item['file']['file_name'] == dato['file']['file_name']: \n                        hoststhreats+=f\"\u003cli\u003e{dato['computer']['hostname']}\u003c/li\u003e\\n\"\n                except:\n                    continue\n            hoststhreats = list(set(hoststhreats.split(\"\\n\")))\n            hoststhreats = '\\n'.join(hoststhreats)\n            amenaza += f'\u003ctr\u003e\u003ctd class=\"text-justify\" style=\"font-size: 12px;\"\u003eSeveridad \u003cb\u003e{item[\"severity\"]}\u003c/b\u003e detected \u003cb\u003e{item[\"file\"][\"file_name\"]}\u003c/b\u003e \u003c/td\u003e \u003ctd class=\"text-justify\" style=\"font-size: 12px;\"\u003e{hoststhreats}\u003c/td\u003e \u003c/tr\u003e*'\n    except:\n        continue\n\n#**************************************************************************************************************************************************************#\n#hosts = json.dumps(hosts)\nbyEventNames=''\nbyEventSeverities = ''\nbyHostNames = ''\nbyHostSeverities = ''\n\n#Formato de correo electrónico para mostrar tabla con los eventos resgitrados, sus severidades y el conteo de cada severidad\nfor evento in eventos:\n    #byEventNames += f'{evento[0]}\\n'\n    for event in severidades_evento:\n        if event['Evento'] == evento[0]:\n            byEventSeverities += f'\u003ctd class=\"text-justify\" style=\"font-size: 12px;\"\u003e{event[\"Severidades\"].count(\"Low\")}\u003c/td\u003e  \u003ctd class=\"text-justify\" style=\"font-size: 12px;\"\u003e{event[\"Severidades\"].count(\"Medium\")}\u003c/td\u003e  \u003ctd class=\"text-justify\" style=\"font-size: 12px;\"\u003e{event[\"Severidades\"].count(\"High\")}\u003c/td\u003e  \u003ctd class=\"text-justify\" style=\"font-size: 12px;\"\u003e{event[\"Severidades\"].count(\"Critical\")}\u003c/td\u003e\\n'\n    byEventNames += f'\u003ctr\u003e\u003ctd style=\"font-size: 12px;\"\u003e{evento[0]}\u003c/td\u003e{byEventSeverities}\u003c/tr\u003e'\n    byEventSeverities = ''\n\n#Formato de correo electrónico para mostrar tabla con los hosts resgitrados, sus severidades y el conteo de cada severidad\nfor host in hosts[:5]:\n    #byHostNames += f'{host[\"Hostname\"]}\\n'\n    for hostname in severidades_host :\n        if hostname['Hostname'] == host[\"Hostname\"]:\n            byHostSeverities += f'\u003ctd class=\"text-justify\"\u003e{hostname[\"Severidades\"].count(\"Low\")}\u003c/td\u003e  \u003ctd class=\"text-justify\"\u003e{hostname[\"Severidades\"].count(\"Medium\")}\u003c/td\u003e  \u003ctd class=\"text-justify\"\u003e{hostname[\"Severidades\"].count(\"High\")}\u003c/td\u003e  \u003ctd class=\"text-justify\"\u003e{hostname[\"Severidades\"].count(\"Critical\")}\u003c/td\u003e\\n'\n    byHostNames += f'\u003ctr\u003e\u003ctd style=\"font-size: 12px;\"\u003e{host[\"Hostname\"]}\u003c/td\u003e{byHostSeverities}\u003c/tr\u003e'\n    byHostSeverities = ''\n\n#Se asegura de que no haya repetidos en amenaza\namenaza = list(set(amenaza.split(\"*\")))\namenaza = ''.join(amenaza)\n\n#**************************************************************************************************************************************************************#",
          "script_arguments": [
            "$workflow.definition_workflow_026YKAY5RHYOW7Z8Zf5dqKPJTadS6QonClX.local.variable_workflow_026YKDF8BBRIZ2s4ao9nZFgUpFjReRJpR2j$"
          ],
          "script_queries": [
            {
              "script_query": "byEventNames",
              "script_query_name": "e1",
              "script_query_type": "string"
            },
            {
              "script_query": "byHostNames",
              "script_query_name": "h1",
              "script_query_type": "string"
            },
            {
              "script_query": "amenaza",
              "script_query_name": "amenaza-host",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_026Z5GOKQ53OZ1Z5pqtUsK5gIhX2vslQK1D",
        "name": "Webex - Simple Card v3 (Dashboard Table)",
        "title": "Webex - Simple Card v3 (Dashboard Table)",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Webex - Simple Card v3 (Dashboard Table)",
          "input": {
            "variable_workflow_026Z56TPWVUUO2BGjXwnaIzHb8x2oIpPwrg": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.ev1$",
            "variable_workflow_026Z56TPWW5740VA8vTH5YbdAT6nDo7adOM": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.ev2$",
            "variable_workflow_026Z56TPWWCY923jNmk24dZ76LYP5Ljl1g0": "-",
            "variable_workflow_026Z56TPWWS0T2GAbzpqTLYPhc7TTZM2hTu": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.ev3$",
            "variable_workflow_026Z56TPWWYZV2dy5NILY7Oco4xgKVtKdEA": "Y2lzY29zcGFyazovL3VzL1JPT00vZjExMzhiMjAtMDU0Yi0xMWVlLWFhMDctMjEyZmQxMGQ2NDFi",
            "variable_workflow_026Z56TPWX7N23h4FIGfBOzVXgoLeUIqJqE": "-",
            "variable_workflow_026Z56TPWXSZJ7K11yWYqtIb7ktEoouWXQo": "-",
            "variable_workflow_026Z56TPWY0EK0fC6jXKg6FK6j4FA64IbBv": "SecureX - Dashboard AMP",
            "variable_workflow_026Z56TPWY7CW1amPZwPSUh4WmWMGke8PwF": "-",
            "variable_workflow_026Z56TPWYFHJ2w9n4ys9UodTRuJiE9ZXSk": "A continuación se muestra un resumen de los eventos detectados por Secure Endpoint en las últimas 24 horas",
            "variable_workflow_026Z56TPWYN8M04OfQXIwiZsXlDmg0F69vS": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.e2$",
            "variable_workflow_026Z56TPWYV987Sj6zZO2yXVQbmIoLqFqfn": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.e1$",
            "variable_workflow_026Z56TPWZ3061hKEQnemR01I0H5hBlmfiF": "-",
            "variable_workflow_026Z56TPWZH333pUyuFnDVhMzpRo0RG77L1": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.e3$",
            "variable_workflow_026Z56TPWZOFK7hENLuh48xLNbFwVaZ8PSQ": "$global.variable_022B52NJV0UOT26gcH8lQJHhWaaFyVQ38SI.global.variable_022B52NJV0UOT26gcH8lQJHhWaaFyVQ38SI$",
            "variable_workflow_026Z56TPWZVPY00XbwcGaqAIsugnP7yv5e6": "-",
            "variable_workflow_026Z58NI0YOT56uztMn7a4cXamLCMJ5ybRb": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h1$",
            "variable_workflow_026Z58XLDYJ334D86n3BUy8NE0NLYgKA1jb": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h2$",
            "variable_workflow_026Z59498YJAE4Sg3j7ZHhS5LXHUW7IfveF": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h3$",
            "variable_workflow_026Z5B1HZ5MRI00KQ4aMNbBZ8fTvkaP9zrj": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h4$",
            "variable_workflow_026Z5B7KDYJYF4PV9WDbo1Cv1WUW1YcnWcN": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h5$",
            "variable_workflow_026Z5BCMW8XSO0abk6pLO65quiLKFOUvzzJ": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.hv1$",
            "variable_workflow_026Z5BH4Q2X152Kwza0u2yFKJaFDMMbtP3S": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.hv2$",
            "variable_workflow_026Z5BM1FCKFI4NMAypKh0yNxdBl472QvNK": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.hv4$",
            "variable_workflow_026Z5BRFYCKTH6S2FVCheyc9lIeAemTGQmJ": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.hv3$",
            "variable_workflow_026Z5BW6NC0LY3dskhEqY8s5YBd2G1VisFZ": "$activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.hv5$"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": true,
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_01J5LR4RYGF8G17FIct2UtullgqVVJBcRcC",
            "target_type": "web-service.endpoint"
          },
          "workflow_id": "definition_workflow_026Z56TP8CVQ80GXggcpXMhqR7PgOU45X8o",
          "workflow_name": "Webex - Simple Card v3 (Dashboard Table)"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_026ZFSGZT9UC74DnKfXvfI0Dgzi1HqH3vJN",
        "name": "Send Email",
        "title": "Send Email",
        "type": "email.smtp_send_email",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "body": "\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /\u003e\n    \u003ctitle\u003eSecure Endpoint Daily Report\u003c/title\u003e\n    \u003cstyle\u003e\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n        }\n        h1 {\n            text-align: center;\n            font-size: 24px;\n            margin-bottom: 20px;\n        }\n        h2 {\n            text-align: center;\n            font-size: 18px;\n            margin-bottom: 10px;\n        }\n        table {\n            border-collapse: collapse;\n            margin: 0 auto;\n            width: 80%;\n        }\n        th, td {\n            border: none;\n            padding: 8px;\n            text-align: center;\n        }\n        th {\n            background-color: #f2f2f2;\n        }\n        .footer {\n            text-align: center;\n            margin-top: 50px;\n        }\n        .footer img {\n            max-width: 200px;\n        }\n        .title img {\n            max-width: 35px;\n            display: block;\n            margin: 0 auto;\n            margin-bottom: 20px;\n            \n        }\n        .text-justify {\n            text-align: justify;\n        }\n        details {\n            margin-top: 10px;\n        }\n\n\n        summary {\n            font-weight: bold;\n            cursor: pointer;\n        }\n\n        details \u003e div {\n            margin-left: 20px;\n            margin-bottom: 10px;\n        }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"title\"\u003e\n        \u003c!--img src=\"https://play-lh.googleusercontent.com/yecx-qGUGuCy0cdDvG4096pI9WIcXiCQPCKyt13vRKg5XqRbFOVVv2K3evGNK0lk3d0\" alt=\"Logo Tecnología\"--\u003e\n        \u003ch1\u003eSecure Endpoint Daily Report\u003c/h1\u003e\n    \u003c/div\u003e\n\n    \u003ch2\u003eA continuación se muestra el top 5 de eventos identificados por Secure Endpoint en las últimas 24 horas\u003c/h2\u003e\n\n    \u003ch2\u003ePor Evento\u003c/h2\u003e\n    \n\u003ctable\u003e\n        \u003ctr\u003e\n        \u003ctd colspan=\"2\" style=\"text-align: center; font-weight: bold;\"\u003eDetalles de severidad\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003cth\u003eEvento\u003c/th\u003e\n            \u003cth\u003eBaja\u003c/th\u003e\n            \u003cth\u003eMedia\u003c/th\u003e\n            \u003cth\u003eAlta\u003c/th\u003e\n            \u003cth\u003eCrítica\u003c/th\u003e\n        \u003c/tr\u003e\n        $activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.e1$\n        \n       \u003c/table\u003e\n\n\n    \u003ch2 style=\"margin-top: 40px;\"\u003ePor hostname\u003c/h2\u003e\n   \n\u003ctable\u003e\n        \u003ctr\u003e\n        \u003ctd colspan=\"2\" style=\"text-align: center; font-weight: bold;\"\u003eDetalles de severidad\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003cth\u003eHostname\u003c/th\u003e\n            \u003cth\u003eBaja\u003c/th\u003e\n            \u003cth\u003eMedia\u003c/th\u003e\n            \u003cth\u003eAlta\u003c/th\u003e\n            \u003cth\u003eCrítica\u003c/th\u003e\n        \u003c/tr\u003e\n        $activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h1$\n        \n    \u003c/table\u003e\n\n\n\u003ch2 style=\"margin-top: 40px;\"\u003eLista de Eventos del Ultimo día\u003c/h2\u003e\n\u003ctable\u003e\n        \u003ctr\u003e\n        \u003ctd colspan=\"2\" style=\"text-align: center; font-weight: bold;\"\u003eDetalle de Eventos\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003cth\u003eEvento Detectado\u003c/th\u003e\n            \u003cth\u003eHostname\u003c/th\u003e\n            \n        \u003c/tr\u003e\n        \n        $activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.amenaza-host$\n    \u003c/table\u003e\n\n\n    \u003cdiv class=\"footer\"\u003e\n        \u003cimg src=\"https://play-lh.googleusercontent.com/yecx-qGUGuCy0cdDvG4096pI9WIcXiCQPCKyt13vRKg5XqRbFOVVv2K3evGNK0lk3d0\" alt=\"Logo Tecnología\"\u003e\n        \u003cbr\u003e\n        \u003cimg src=\"https://i.ibb.co/crd5y14/grupo-porreslogo-cabecera80x274.png\" alt=\"Logo Empresarial\"\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e",
          "cc": "luis.vera@voseda.com, giovanna.reynoso@voseda.com, fernando.luna@voseda.com",
          "continue_if_one_address_valid": false,
          "continue_on_failure": false,
          "display_name": "Send Email",
          "from": "noc-soc@voseda.com",
          "html": true,
          "runtime_user": {
            "override_target_runtime_user": true,
            "runtime_user_id": "definition_runtime_user_01YYP28YWNN2B6f9WRw4p9lfiC5kQs2rLkH"
          },
          "skip_execution": false,
          "subject": "Securex - Secure Endpoint Daily Dashboard",
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_01MVDDNCVRVKI5u5P8aMhM2WA9UfbONcrMF"
          },
          "to": "fferia@gporres.com.mx,practicanteti@gporres.com.mx"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02921OPTI1Z9L2arnOiGVTLEa96GhVRuDqG",
        "name": "Send Email",
        "title": "Send Email",
        "type": "email.smtp_send_email",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "body": "\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /\u003e\n    \u003ctitle\u003eSecure Endpoint Daily Report\u003c/title\u003e\n    \u003cstyle\u003e\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n        }\n        h1 {\n            text-align: center;\n            font-size: 24px;\n            margin-bottom: 20px;\n        }\n        h2 {\n            text-align: center;\n            font-size: 18px;\n            margin-bottom: 10px;\n        }\n        table {\n            border-collapse: collapse;\n            margin: 0 auto;\n            width: 80%;\n        }\n        th, td {\n            border: none;\n            padding: 8px;\n            text-align: center;\n        }\n        th {\n            background-color: #f2f2f2;\n        }\n        .footer {\n            text-align: center;\n            margin-top: 50px;\n        }\n        .footer img {\n            max-width: 200px;\n        }\n        .title img {\n            max-width: 35px;\n            display: block;\n            margin: 0 auto;\n            margin-bottom: 20px;\n            \n        }\n        .text-justify {\n            text-align: justify;\n        }\n        details {\n            margin-top: 10px;\n        }\n\n\n        summary {\n            font-weight: bold;\n            cursor: pointer;\n        }\n\n        details \u003e div {\n            margin-left: 20px;\n            margin-bottom: 10px;\n        }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"title\"\u003e\n        \u003c!--img src=\"https://play-lh.googleusercontent.com/yecx-qGUGuCy0cdDvG4096pI9WIcXiCQPCKyt13vRKg5XqRbFOVVv2K3evGNK0lk3d0\" alt=\"Logo Tecnología\"--\u003e\n        \u003ch1\u003eSecure Endpoint Daily Report\u003c/h1\u003e\n    \u003c/div\u003e\n\n    \u003ch2\u003eA continuación se muestra el top 5 de eventos identificados por Secure Endpoint en las últimas 24 horas\u003c/h2\u003e\n\n    \u003ch2\u003ePor Evento\u003c/h2\u003e\n    \n\u003ctable\u003e\n        \u003ctr\u003e\n        \u003ctd colspan=\"2\" style=\"text-align: center; font-weight: bold;\"\u003eDetalles de severidad\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003cth\u003eEvento\u003c/th\u003e\n            \u003cth\u003eBaja\u003c/th\u003e\n            \u003cth\u003eMedia\u003c/th\u003e\n            \u003cth\u003eAlta\u003c/th\u003e\n            \u003cth\u003eCrítica\u003c/th\u003e\n        \u003c/tr\u003e\n        $activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.e1$\n        \n       \u003c/table\u003e\n\n\n    \u003ch2 style=\"margin-top: 40px;\"\u003ePor hostname\u003c/h2\u003e\n   \n\u003ctable\u003e\n        \u003ctr\u003e\n        \u003ctd colspan=\"2\" style=\"text-align: center; font-weight: bold;\"\u003eDetalles de severidad\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003cth\u003eHostname\u003c/th\u003e\n            \u003cth\u003eBaja\u003c/th\u003e\n            \u003cth\u003eMedia\u003c/th\u003e\n            \u003cth\u003eAlta\u003c/th\u003e\n            \u003cth\u003eCrítica\u003c/th\u003e\n        \u003c/tr\u003e\n          $activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.h1$\n    \u003c/table\u003e\n\n\n\u003ch2 style=\"margin-top: 40px;\"\u003eLista de Eventos del Ultimo día\u003c/h2\u003e\n\u003ctable\u003e\n        \u003ctr\u003e\n        \u003ctd colspan=\"2\" style=\"text-align: center; font-weight: bold;\"\u003eDetalle de Eventos\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003cth\u003eEvento Detectado\u003c/th\u003e\n            \u003cth\u003eHostname\u003c/th\u003e\n            \n        \u003c/tr\u003e\n        \n        $activity.definition_activity_026YKVP2X93MW2OPZVLYDIYF1VhvV9sml48.output.script_queries.amenaza-host$\n    \u003c/table\u003e\n\n\n    \u003cdiv class=\"footer\"\u003e\n        \u003cimg src=\"https://play-lh.googleusercontent.com/yecx-qGUGuCy0cdDvG4096pI9WIcXiCQPCKyt13vRKg5XqRbFOVVv2K3evGNK0lk3d0\" alt=\"Logo Tecnología\"\u003e\n        \u003cbr\u003e\n        \u003cimg src=\"https://i.ibb.co/crd5y14/grupo-porreslogo-cabecera80x274.png\" alt=\"Logo Empresarial\"\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e",
          "continue_if_one_address_valid": false,
          "continue_on_failure": false,
          "display_name": "Send Email",
          "from": "noc-soc@voseda.com",
          "html": true,
          "runtime_user": {
            "override_target_runtime_user": true,
            "runtime_user_id": "definition_runtime_user_01YYP28YWNN2B6f9WRw4p9lfiC5kQs2rLkH"
          },
          "skip_execution": true,
          "subject": "Securex - Secure Endpoint Daily Dashboard",
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_01MVDDNCVRVKI5u5P8aMhM2WA9UfbONcrMF"
          },
          "to": "luz.yong@voseda.com"
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "triggers": {
    "triggerschedule_02700Y5NN8ZVI6mhrOgMlnQ6hY3ZXRsgTau": {
      "workflow_id": "definition_workflow_026YKAY5RHYOW7Z8Zf5dqKPJTadS6QonClX",
      "name": "Every day",
      "title": "",
      "lowercase_name": "schedule.every_day",
      "type": "schedule",
      "base_type": "trigger",
      "ref_id": "schedule_022CMHBDL5RGZ32ur9dyrfpAlybMXgPgqET",
      "version": "",
      "disabled": false,
      "unique_name": "triggerschedule_02700Y5NN8ZVI6mhrOgMlnQ6hY3ZXRsgTau",
      "object_type": "triggerschedule"
    }
  },
  "schedules": {
    "schedule_022CMHBDL5RGZ32ur9dyrfpAlybMXgPgqET": {
      "unique_name": "schedule_022CMHBDL5RGZ32ur9dyrfpAlybMXgPgqET",
      "name": "Every Day at 1 PM",
      "type": "basic.schedule",
      "base_type": "schedule",
      "object_type": "schedule",
      "rule_id": "",
      "properties": {
        "calendar": "calendar_recurring_1BMfMWvgiDhSjBQ7hTSyvz3NyVZ",
        "timezone": "America/Mexico_City",
        "starttime": "13:00",
        "interval_hours": 0,
        "interval_minutes": 0,
        "number_of_times": 1,
        "display_name": "Every Day at 1 PM",
        "description": ""
      },
      "version": "1.0.0"
    }
  },
  "targets": {
    "definition_target_01J5LR4RYGF8G17FIct2UtullgqVVJBcRcC": {
      "unique_name": "definition_target_01J5LR4RYGF8G17FIct2UtullgqVVJBcRcC",
      "name": "Webex Teams",
      "title": "Webex Teams",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "Webex Teams",
        "disable_certificate_validation": false,
        "display_name": "Webex Teams",
        "host": "webexapis.com",
        "no_runtime_user": true,
        "port": 443,
        "protocol": "https"
      }
    },
    "definition_target_01MVDDNCVRVKI5u5P8aMhM2WA9UfbONcrMF": {
      "unique_name": "definition_target_01MVDDNCVRVKI5u5P8aMhM2WA9UfbONcrMF",
      "name": "Email Endpoint",
      "title": "Email Endpoint",
      "type": "email.smtp_endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "Email Endpoint",
        "display_name": "Email Endpoint",
        "no_runtime_user": true,
        "port": 587,
        "protocol": "SMTP",
        "server": "smtp.office365.com"
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_01YYP28YWNN2B6f9WRw4p9lfiC5kQs2rLkH": {
      "unique_name": "definition_runtime_user_01YYP28YWNN2B6f9WRw4p9lfiC5kQs2rLkH",
      "name": "Noc Soc",
      "title": "Noc Soc",
      "type": "runtime_user.email_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "display_name": "Noc Soc",
        "password": "*****",
        "sender": "noc-soc@voseda.com"
      }
    }
  },
  "variables": {
    "variable_022B52NJV0UOT26gcH8lQJHhWaaFyVQ38SI": {
      "unique_name": "variable_022B52NJV0UOT26gcH8lQJHhWaaFyVQ38SI",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "NotiBot Voseda Token",
        "type": "datatype.secure_string",
        "is_required": false,
        "display_on_wizard": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "atomic_workflows": [
    "definition_workflow_026Z56TP8CVQ80GXggcpXMhqR7PgOU45X8o"
  ],
  "dependent_workflows": [
    "definition_workflow_026Z56TP8CVQ80GXggcpXMhqR7PgOU45X8o"
  ]
}